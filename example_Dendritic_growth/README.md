# 3D_dendritic_growth_PFM_SGPU

The basic model is given by " Ryo Kobayashi (1994) A Numerical Approach to Three-Dimensional Dendritic Solidification, Experimental Mathematics, 3:1, 59-81, DOI: 10.1080/10586458.1994.10504577", it's a 3D pure material dendritic growth phase-field model with dimensionless undercooling and anisotropic potential (not directly interfacial anisotropy for simplicity).

The governing equation is:

$E_{total} = \int (\frac{1}{2}\epsilon^2|\nabla p|^2 + F(p, m))dV$

$F(p, m) = \int^p_0 p'(p'+1)(p'-\frac{1}{2} + m)dp'$

where $m\in (-\frac{1}{2},\frac{1}{2})$, $F(0, m) - F(1, m) =\frac{1}{6}m$, so $m>0$ for solid phase ($p=1$), $m<0$ for liquid ($p=0$).

The evolution equation is:

$\tau \frac{\partial p}{\partial t} = \epsilon^2 \nabla^2 p + p(1-p)[p-\frac{1}{2}+m(T, -\nabla p)]$

$\frac{\partial T}{\partial t} = \nabla^2 T + \frac{\partial p}{\partial t}$

$m(T, \bf v) = -\frac{\alpha}{\pi} \tan^{-1}(\gamma \sigma(\bf v)T)$

$\sigma(\bf v) = 1-\delta(1-\frac{|\bf v|^4_4}{|\bf v|^4_2})$

The later two equations are for anisotropic potential, and it forms a cubic anisotropy. $\sigma(\bf v) = 1$ (max) for $\bf v = (1, 0, 0)$; $\sigma(\bf v) = 1 - \frac{1}{2}\delta$ for $\bf v = (1, 1, 0)$; $\sigma(\bf v) = 1 - \frac{2}{3}\delta$ for $\bf v = (1, 1, 1)$. The amplitude of the anisotropy can be manipulated by changing $\delta$ from 0 to 1.

$\tau = 3.0\times 10^{-4}, \epsilon = 1.0\times 10^{-2}, \alpha = 0.9, \gamma = 40.0, \delta x = \delta y = \delta z = 3.0\times 10^{-2},$ and $\delta t = 1.0\times 10^{-4}$. The initial condition is set by adding a nucleus in an initially $T=-\Delta = -0.25$ uniform system with adiabatic boundaries.


## About dendritic growth model execution and post-operations
1. The model should be compiled with
   ```
   nvcc -o 3D_dendritic_growth kernel.cu -std=c++11
   ```

2. mode = 0 in input file means all blocks activated while =1 means regular DBA with separate criteria for p and T.

3. The RTValues.out file documents the simulation step, growth velocity, activation portion of p, activation portion of T, and computed steps per second. The frequency of this output can be modified by RT_freq of main function in kernel.cu file.

4. The radius rate is generated by reading the output .vtk files of variable p (e.g., p_2000.vtk or w_p_2000.vtk). To do so, run the following commands:
  ```
  g++ -o Extract_Tip Extract_Tip.cpp
  ./Extract_Tip p_1000.vtk p_2000.vtk
  ```
  this generates the tip profiles (z and y) from p_1000.vtk and p_2000.vtk (can add any amount of .vtk files in command line) into Tip_Profile.dat.
